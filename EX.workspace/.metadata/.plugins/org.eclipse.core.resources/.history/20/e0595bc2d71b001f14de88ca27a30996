--1. 그룹화 관련함수
--1-1. ROLLUP 
--처음에는 GROUP BY에 지정된 모든 칼럼으로 그룹화된 결과를 보여주고 
--다음부터는 마지막에 지정된 컬럼을 하나씩 뺀 그룹화된 결과를 보여주다가 
--마지막에는 그룹화되지 않은 전체 데이터에 대한 결과를 보여준다. 
--ROLLUP을 사용하지 않았을때 
SELECT DNO 
 	, JOB 
 	, MAX(SAL)
 	, SUM(SAL)
 	, AVG(SAL)
 	, COUNT(*)
 	FROM EMP 
 	GROUP BY DNO, JOB;
 	
 -- ROLLUP 사용 시 
 
 SELECT DNO 
 	, JOB 
 	, MAX(SAL)
 	, SUM(SAL)
 	, AVG(SAL)
 	, COUNT(*)
 	FROM EMP 
 	GROUP BY ROLLUP(DNO, JOB);
 	
 
 --하위 개념과 같은 것이 ROLLUP함수
 SELECT DNO 
	 , JOB
 	, MAX(SAL)
 	, SUM(SAL)
 	, AVG(SAL)
 	, COUNT(*)
 	FROM EMP 
 	GROUP BY DNO, JOB
 UNION
 SELECT DNO 
  	, MAX(SAL)
 	, SUM(SAL)
 	, AVG(SAL)
 	, COUNT(*)
 	FROM EMP 
 	GROUP BY DNO
  UNION
 SELECT  
 	, MAX(SAL)
 	, SUM(SAL)
 	, AVG(SAL)
 	, COUNT(*)
 	FROM EMP 
 	GROUP BY EMP;
 	
 --ROLLUP 함수를 이용해서 전공별 학년별 평균편점, 평점의 총합, 최고 평점 조회
 --전공별 평균평점, 평점의 총합, 최고 평점 조회
 --전체 학생에 대한 평균평점, 평점의 총합, 최고 평점 조회
 
 SELECT MAJOR 
 	, SYEAR 
 	,AVG(AVR) 
 	,SUM(AVR)
 	,MAX(AVR)
 	,COUNT(*)
 	FROM STUDENT
 	-- 	GROUP BY MAJOR, SYEAR;
 --순서대로 빠지기 때문에 MAJOR 가 빠진 값은 없다.
 	GROUP BY ROLLUP (MAJOR, SYEAR);
 
 --1-2. CUBE 
 --ROLLUP 함수와 지정방식은 동일하지만 동작 방식이 다르다. 
 --ROLLUP 함수가 GROUP BY에 지정된 컬럼을 뒤에서부터 하나씩 뺴면서 그룹화를 진행한다면 
 --CUBE 함수는 GROUP BY에 지정된 모든 조합에 대한 그룹화를 진행한다.
 SELECT MAJOR 
 	, SYEAR 
 	, SEX 
 	, AVG(AVR)
 	, SUM(AVR)
 	, MAX(AVR)
 	, COUNT(*)
 	FROM STUDENT 
 	GROUP BY ROLLUP(MAJOR, SYEAR, SEX);
 
 
 