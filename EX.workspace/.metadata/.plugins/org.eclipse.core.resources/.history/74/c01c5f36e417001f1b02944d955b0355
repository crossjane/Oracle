--1. INNER JOIN 
--JOIN 은 여러 테이블에 분산되어 있는 데이터를 한 번에 조회하기 위해 사용하는 기능 
--JOIN 에는 INNER JOIN 과 OUTER JOIN 이 존재한다.
--JOIN절에는 항상 공통 컬럼에 해당하는 조건을 ON절로 만들어줘야한다.
--INNER JOIN 은 두 테이블에 공통된 데이터를 조회하는 기능 
--두테이블에 존재하는 공통된 컬럼을 조인 조건으로 명시한다.
--학생의 학생번호, 학생이름, 과목번호, 기말고사 성적 조회 
SELECT ST.SNO
 	 , ST.SNAME
 	 , SC.CNO
 	 , SC.RESULT
 	 FROM STUDENT ST
 	 INNER JOIN SCORE SC
 	 	ON ST.SNO = SC.SNO
 	 ORDER BY ST.SNO;

--과목번호, 과목이름, 담당교수 번호, 담당교수 이름 조회(COURSE, PROFESSOR 테이블 조인)
 	
 SELECT CS.CNO
 	  , CS.CNAME
 	  , PS.PNO
 	  , PS.PNAME
 	  FROM COURSE CS 
 	  INNER JOIN PROFESSOR PS 
 	  ON CS.PNO = PS.PNO;
 	 
 --INNER JOIN 에서 INNER는 생략 가능하다. 
  SELECT CS.CNO
 	  , CS.CNAME
 	  , PS.PNO
 	  , PS.PNAME
 	  FROM COURSE CS 
 	  JOIN PROFESSOR PS 
 	  ON CS.PNO = PS.PNO;
 
--1-1. 등가 조인 
--등가조인은 공통된 컬럼의 데이터가 같은 데이터만을 조회하는 조인
--사원의 사원번호, 사원이름, 업무, 급여, 보너스, 부서번호, 부서이름, 부서지역 조회   	 
--ANSI 표준방식 
 	 
SELECT E.ENO
	 , E.ENAME
	 , E.JOB
	 , E.SAL
	 , E.COMM
	 , E.DNO
	 , D.LOC
	 , D.DNAME
	 FROM EMP E
	 JOIN DEPT D
	 ON E.DNO = D.DNO;
 	
--ORACLE에서만 사용하는 방식의JOIN 
SELECT E.ENO
	 , E.ENAME
	 , E.JOB
	 , E.SAL
	 , E.COMM
	 , E.DNO
	 , D.LOC
	 , D.DNAME
	 FROM EMP E
		, DEPT D
	 WHERE E.DNO = D.DNO;
	
--세개 테이블 이상의 테이블 조인 
--학생의 학생번호, 학생이름, 과목번호, 과목이름, 기말고사성적 조회
	
SELECT ST.SNO
 	 , ST.SNAME
 	 , SC.CNO
 	 , C.CNAME
 	 , SC.RESULT
 	 FROM STUDENT ST
 	 JOIN SCORE SC
 	   ON ST.SNO = SC.SNO 
 	 JOIN COURSE C 
 	   ON SC.CNO = C.CNO
 	  ORDER BY SNO;
 	
 	 
--학생의 학생번호, 학생이름, 과목번호, 과목이름, 기말고사성적, 담당교수번호, 담당교수 이름 조회 	
 
SELECT ST.SNO
 	 , ST.SNAME
 	 , SC.CNO
 	 , C.CNAME
 	 , SC.RESULT
 	 , P.PNO
 	 , P.PNAME
 	 FROM STUDENT ST
 	 JOIN SCORE SC
 	   ON ST.SNO = SC.SNO 
 	 JOIN COURSE C 
 	   ON SC.CNO = C.CNO
 	 JOIN PROFESSOR P
 	   ON C.PNO = P.PNO
 	  ORDER BY SNO;
 	
 	 
 --1-2.비등가 조인 
 --비등가 조인은 해당 칼럼의 데이터 값이 큰지 작은지, 사잇값인지 부등호나 BETWEEN AND 절을 이용해서 비교하는 조인구문 
 --학생의 학생번호, 학생이름, 과목번호, 과목이름, 기말고사성적 , 기말고사 성적의 등급 조회
 SELECT ST.SNO
 	 , ST.SNAME
 	 , SC.CNO
 	 , C.CNAME
 	 , SC.RESULT
 	 , GR.GRADE 
 	 FROM STUDENT ST
 	 JOIN SCORE SC
 	   ON ST.SNO  = SC.SNO
 	 JOIN COURSE C 
 	   ON SC.CNO = C.CNO
 	 JOIN SCGRADE GR
 	 -- 비등가 조인 사용 
 	   ON SC.RESULT <= GR.HISCORE 
 	  AND SC.RESULT >= GR.LOSCORE
 	 ORDER BY ST.SNO, SC.CNO;

--학생의 학생번호, 학생이름, 과목번호, 과목이름, 기말고사성적 , 기말고사 성적의 등급 조회(BETWEEN AND 절 사용)

 SELECT ST.SNO
 	 , ST.SNAME
 	 , SC.CNO
 	 , C.CNAME
 	 , SC.RESULT
 	 , GR.GRADE 
 	 FROM STUDENT ST
 	 JOIN SCORE SC
 	   ON ST.SNO  = SC.SNO
 	 JOIN COURSE C 
 	   ON SC.CNO = C.CNO
 	 JOIN SCGRADE GR 
 	 --비등가조인사용
 	   ON SC.RESULT BETWEEN GR.LOSCORE AND GR.HISCORE
 	 ORDER BY ST.SNO, SC.CNO;
 	 
 	 
 --사원의 사원번호, 사원이름, 급여, 급여등급 조회(EMP, SALGRADE)
 
SELECT E.ENO
	 , E.ENAME
	 , E.SAL
	 , S.GRADE
  FROM EMP E
  JOIN SALGRADE S
    ON E.SAL BETWEEN S.LOSAL AND S.HISAL 
    ORDER BY E.ENO, E.ENAME;
 	 
--1-3. 셀프조인 
--조인되는 두 테이블이 동일할 때 셀프조인이라 부른다. 	 
 	 
 	 
 	 
 	 
 	 