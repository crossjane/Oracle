--1. 추가적인 조인 
--1-1. NATURAL JOIN : 조인 조건을 명시하지 않아도 자동으로 조인될 컬럼을 추적해서 조인을 해주는 조인 
--조인되는 컬럼은 테이블의 별칭을 사용할 수 없다. 
--학생의 학생번호, 학생이름, 기말고사 성적 조회
SELECT ST.SNO
	 , ST.SNAME 
	 , SC.CNO 
	 , SC.RESULT
	 FROM STUDENT ST 
	 JOIN SCORE SC 
	 ON ST.SNO = SC.SNO 
	 ORDER BY ST.SNO, SC.CNO;

	
--NATURAL JOIN 사용 
	--어떻게 자동?? 그럼 이너 조인이랑 그냥 똑같은거 아님?? 
	
	
SELECT SNO 
	 , ST.SNAME 
	 , SC.CNO 
	 , SC.RESULT 
	 FROM STUDENT ST 
	 NATURAL JOIN SCORE SC 
	 ORDER BY SNO, SC.CNO;
	
	--아예 교집합만 가저오는것??
	
--NATURAL JOIN을 이용해서 학생번호, 학생이름, 해당 학생의 기말고사 평균 점수 조회
	
SELECT  S.SNAME 
	 , SC.RESULT
FROM  STUDENT S
NATURAL JOIN SCORE SC;

SELECT SNO 
	 ,ST.SNAME 
	 , AVG(SC.RESULT)
	 FROM STUDENT ST 
	 NATURAL JOIN SCORE SC
	GROUP BY SNO, ST.SNAME ;

SELECT SNO 
	 , AVG(RESULT)
	 FROM SCORE 
	 GROUP BY SNO 

	
--NATURAL JOIN을 이용해서 최대급여가 4000만원 이상인 부서번호, 부서이름, 최대급여 조회
SELECT MAX(E.SAL)
	, D.DNAME
	FROM DEPT D 
	NATURAL JOIN EMP E
	WHERE MAX(E.SAL) >= 4000;
	
	



	
	
SELECT A.MAX_SAL	

	FROM  ( SELECT MAX(E.SAL) AS MAX_SAL
				 , D.DNO 
				 , D.DNAME
				 FROM DEPT D 
				 JOIN EMP E
				 ON D.DNO = E.DNO
	)A
	NATURAL JOIN EMP E;
		 
	 
	 
	 
	 
	 
	 
	